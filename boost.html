<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>D1SN — Boost & Completion Tracker</title>

<!-- THEME: black background, white headings, gold accents -->
<style>
:root{
  --bg:#0b0b0b; --card:#141414; --line:#232323; --stripe:#161616;
  --text:#e6e6e6; --muted:#a6a6a6;
  --gold:#d5b15b; --accent:#f2d675;
  --btn-a:#1a1a1a; --btn-b:#262626; --btn-glow:#f2d67566;
  --win-bg:#143a29; --win-fg:#bff8d7;
  --loss-bg:#3f2629; --loss-fg:#ffd0d0;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
h1,h2{color:#fff;margin:0 0 .6rem}
a{color:var(--gold);text-decoration:none}
.section{max-width:1200px;margin:0 auto;padding:18px 14px}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px}
.small{font-size:.92rem;color:#b0b0b0}
.muted{color:var(--muted)}
.grid{display:grid;gap:14px;grid-template-columns:1fr}
@media(min-width:1100px){.grid{grid-template-columns:1fr 1fr}}

.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid #2a2a2a;padding:8px 10px;text-align:left;vertical-align:top}
.table th{color:#fff;cursor:pointer;user-select:none}
.table tbody tr:nth-child(even){background:var(--stripe)}
.cell-win{background:var(--win-bg);color:var(--win-fg);border-radius:6px;padding:3px 8px}
.cell-loss{background:var(--loss-bg);color:var(--loss-fg);border-radius:6px;padding:3px 8px}

/* Team accents */
.teamTag{display:inline-flex;align-items:center;gap:8px;padding:2px 8px;border-radius:8px;border:1px solid #333;background:#101010}
.teamTag::before{content:"";width:10px;height:10px;border-radius:3px;background:var(--tcol,#777)}
.teamRow{border-left:6px solid var(--tcol,#555);background:linear-gradient(90deg,var(--tbg,transparent),transparent 55%)}

/* Ticker */
.ticker{position:sticky;top:0;z-index:999;background:linear-gradient(90deg,#121212,#181818);border-bottom:1px solid #1f1f1f}
.twrap{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:10px;padding:10px 14px;flex-wrap:wrap}
.tlogo{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:10px;background:linear-gradient(180deg,#f7e8a5,#d6b458 60%,#a3832c);color:#111;font-weight:900;letter-spacing:.6px;border:1px solid #caae51}
.track{overflow:hidden;flex:1;min-width:280px}
.row{display:inline-flex;gap:28px;align-items:center;white-space:nowrap;animation:marquee 30s linear infinite}
.row:hover{animation-play-state:paused}
.row>*{font-weight:900;letter-spacing:.3px;position:relative;padding-right:36px;margin-right:36px}
.row>*::after{content:"";position:absolute;right:8px;top:50%;transform:translateY(-50%);width:6px;height:24px;background:linear-gradient(180deg,#f7e8a5,#d6b458 60%,#a3832c);border-radius:3px}
@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.cta{margin-left:8px;border:1px solid #3c3c3c;padding:8px 14px;border-radius:12px;color:#fff;background:linear-gradient(180deg,var(--btn-a),var(--btn-b));box-shadow:0 0 0 2px #000 inset, 0 0 18px var(--btn-glow);font-weight:800;letter-spacing:.2px}

/* Completion grid */
.legend{display:flex;gap:14px;align-items:center;margin:6px 0 12px;flex-wrap:wrap}
.pill{display:inline-flex;align-items:center;gap:6px;border:1px solid #3a3a3a;background:#101010;padding:4px 8px;border-radius:999px;font-size:.85rem}
.pill b{color:#fff}
.comp-wrap{overflow:auto}
.comp{min-width:1020px;border-collapse:collapse;width:100%}
.comp th,.comp td{border-bottom:1px solid #2a2a2a;padding:8px 10px;text-align:center}
.comp th{background:#121212;cursor:pointer;user-select:none}
.comp th.sticky,.comp td.sticky{position:sticky;left:0;background:var(--card);z-index:1;text-align:left}
.comp tbody tr:nth-child(even){background:var(--stripe)}
.badge{display:inline-block;border:1px solid #3a3a3a;background:#111;padding:2px 8px;border-radius:999px;font-size:.8rem;margin-left:8px}
.badge.bonus{border-color:#caae51;color:#111;background:linear-gradient(180deg,#f7e8a5,#d6b458 60%,#a3832c)}
.sortHint{font-size:.8rem;color:var(--muted);margin-top:6px}
.thActive{color:var(--accent)}
</style>
</head>
<body>

<!-- TICKER -->
<div class="ticker">
  <div class="twrap">
    <span class="tlogo">D1SN</span>
    <div class="track"><div class="row" id="tickerRow"><span>Loading ranked finals…</span></div></div>
    <a class="cta" href="#grid">Completion Grid</a>
  </div>
</div>

<section class="section">
  <h1>Boost & Completion Tracker</h1>
  <div class="card">
    <p>Tracks completed <strong>User vs User</strong> and <strong>User vs CPU</strong> games (Weeks 0–6). Week 6 is a <strong>BONUS week</strong> (played = 2 credits, missed = 1 credit). The ticker shows only <em>completed user games where both teams were ranked</em> at kickoff.</p>
    <p class="small muted">Bracket (Top 5 / 10 / 15 / 25) uses the worst of the two ranks (e.g., <strong>#6 Alabama @ #2 Ohio State</strong> ⇒ <strong>Top 10</strong>).</p>
    <p class="small muted"><strong>Former users (effective Week 7):</strong> Oklahoma, USC.</p>
  </div>
</section>

<section class="section grid">
  <div class="card">
    <h2>Completed — User vs User <span class="badge">Users</span></h2>
    <table class="table" id="uvuTable">
      <thead>
        <tr>
          <th data-sort="str">Away</th><th data-sort="num">A</th>
          <th data-sort="str">Home</th><th data-sort="num">H</th>
          <th data-sort="wk">Week</th><th data-sort="str">Bracket</th>
        </tr>
      </thead>
      <tbody id="uvuBody"></tbody>
    </table>
    <div class="sortHint">Tip: Click headers to sort (toggles).</div>
  </div>
  <div class="card">
    <h2>Completed — User vs CPU <span class="badge">Users</span></h2>
    <table class="table" id="uvcpuTable">
      <thead>
        <tr>
          <th data-sort="str">Away</th><th data-sort="num">A</th>
          <th data-sort="str">Home</th><th data-sort="num">H</th>
          <th data-sort="wk">Week</th><th data-sort="str">Bracket</th>
        </tr>
      </thead>
      <tbody id="uvcpuBody"></tbody>
    </table>
    <div class="sortHint">Tip: Click headers to sort (toggles).</div>
  </div>
</section>

<section id="grid" class="section">
  <h2>✅ User Completion Grid <span class="badge bonus">Week 6 = BONUS</span></h2>
  <div class="card comp-wrap">
    <div class="legend">
      <span class="pill"><b>Cells:</b> 1 = completed • 0 = missed • ○ = not in league yet • – = former user</span>
      <span class="pill"><b>Week 6 Bonus:</b> Played = 2 credits • Missed = 1 credit</span>
      <span class="pill"><b>Joined:</b> “On Time” or “Late (W5)”</span>
    </div>
    <table class="comp" id="compTable">
      <thead id="compHead"></thead>
      <tbody id="compBody"></tbody>
    </table>
    <div class="sortHint">Tip: Click any header (Team, W0–W6, Total, Joined) to sort.</div>
  </div>
</section>

<!-- If your host page has d1sn-polls-data, it will override this example -->
<script type="application/json" id="d1sn-polls-data-EXAMPLE" style="display:none">
{
  "pre":[[1,"Georgia"],[2,"Ohio State"],[3,"Notre Dame"],[4,"Texas"],[5,"Alabama"],
         [6,"North Carolina"],[7,"Miami"],[8,"Penn State"],[9,"LSU"],[10,"Clemson"],
         [11,"Minnesota"],[12,"USC"],[13,"Texas Tech"],[14,"Florida State"],[15,"Oklahoma"],
         [16,"Florida"],[17,"Washington"],[18,"Baylor"],[19,"Tennessee"],[20,"Texas A&M"],
         [21,"Colorado"],[22,"Arkansas"],[23,"BYU"],[24,"Utah"],[25,"Illinois"]],
  "now":[[1,"Alabama"],[2,"Miami"],[3,"South Carolina"],[4,"Notre Dame"],[5,"North Carolina"],
         [6,"Ohio State"],[7,"Minnesota"],[8,"Penn State"],[9,"LSU"],[10,"Georgia"],
         [11,"Texas"],[12,"BYU"],[13,"Washington"],[14,"Colorado"],[15,"Texas Tech"],
         [16,"Michigan"],[17,"SMU"],[18,"Indiana"],[19,"Oregon"],[20,"Texas A&M"],
         [21,"Baylor"],[22,"Delaware"],[23,"Utah"],[24,"Arkansas"],[25,"Florida"]]
}
</script>

<script>
/* ========= Team colors ========= */
const TEAM_COLORS={
  "LSU":"#461D7C","Clemson":"#F56600","Arkansas":"#9D2235","Michigan":"#00274C",
  "Texas":"#BF5700","Ohio State":"#BB0000","Miami":"#005030","Delaware":"#00539F",
  "Georgia":"#BA0C2F","Arizona State":"#8C1D40","Florida":"#0021A5","Washington":"#4B2E83",
  "Alabama":"#9E1B32","BYU":"#001A5B","Oklahoma":"#841617","Florida State":"#782F40",
  "Notre Dame":"#0C2340","South Carolina":"#73000A","Illinois":"#E84A27","USC":"#990000",
  "Texas Tech":"#CC0000","Baylor":"#154734","Colorado":"#CFB87C","Texas A&M":"#500000",
  "Penn State":"#041E42","Tennessee":"#FF8200","North Carolina":"#4B9CD3","Utah":"#CC0000",
  "Auburn":"#0C2340","Minnesota":"#7A0019","SMU":"#CE1126","UCLA":"#2774AE",
  "Ole Miss":"#CE1126","Georgia Tech":"#B3A369","Oregon":"#006A00","Indiana":"#990000",
  "Vanderbilt":"#866D4B","Kentucky":"#0033A0","Duke":"#001A57","Louisville":"#AD0000",
  "California":"#003262","Washington State":"#981E32","Syracuse":"#D44500","Pittsburgh":"#003594",
  "Texas State":"#6B2F2F","Central Michigan":"#6E1E3A","Utah State":"#0F2439","Kennesaw State":"#FFC425",
  "Marshall":"#00B140","NC State":"#CC0000","Army":"#232323","Temple":"#A41E35","Iowa":"#000000",
  "Houston":"#C8102E","Vanderbilt":"#866D4B","Virginia":"#232D4B","UCF":"#BA9B37",
  "Missouri":"#F1B82D","Minnesota":"#7A0019","Washington State":"#981E32"
};
function hexToRGBA(hex,a=.14){const m=hex.replace('#','');const n=parseInt(m,16);
  const r=(n>>16)&255,g=(n>>8)&255,b=n&255;return `rgba(${r},${g},${b},${a})`;}
const teamStyle=t=>`--tcol:${TEAM_COLORS[t]||'#555'};--tbg:${hexToRGBA(TEAM_COLORS[t]||'#555',.12)}`;

/* ========= Users / membership windows ========= */
const CORE_USERS=[
  "LSU","Clemson","Arkansas","Michigan","Texas","Ohio State","Miami","Delaware",
  "Georgia","Arizona State","Florida","Washington","Alabama","BYU","Oklahoma",
  "Florida State","Notre Dame","South Carolina","Illinois","USC","Texas Tech",
  "Baylor","Colorado","Texas A&M","Penn State","Tennessee","North Carolina",
  "Utah","Auburn","Minnesota","SMU","UCLA"
];
// Late joiners: Week they joined
const LATE_JOINERS={"Ole Miss":5,"Georgia Tech":5,"Oregon":5};
// Former users: Week they left (active through week-1). Oklahoma + USC leave at Week 7.
const FORMER_USERS={"Oklahoma":7,"USC":7};

const ALL_USERS=[...CORE_USERS, ...Object.keys(LATE_JOINERS), ...Object.keys(FORMER_USERS)];
const joinedWeek = t => (t in LATE_JOINERS) ? LATE_JOINERS[t] : 0;
const leftWeek   = t => (t in FORMER_USERS) ? FORMER_USERS[t] : Infinity;
const activeAtWeek=(team,w)=> joinedWeek(team) <= w && w < leftWeek(team);

/* ========= Polls ========= */
function loadPolls(){
  const el=document.getElementById('d1sn-polls-data')||document.getElementById('d1sn-polls-data-EXAMPLE');
  try{ return JSON.parse(el.textContent.trim()); }catch{ return {pre:[],now:[]} }
}
const POLLS=loadPolls();
const PRE=new Map(POLLS.pre.map(([r,t])=>[t,r]));
const NOW=new Map(POLLS.now.map(([r,t])=>[t,r]));
const rankAt=(team,tag)=> (tag==="now"?NOW:PRE).get(team)||null;

/* ========= Helpers ========= */
const weekNum = label => Number(String(label).replace(/[^0-9]/g,""))||0;
function bracketFrom(aRank,hRank){
  if(aRank==null && hRank==null) return null;
  const worst=Math.max(aRank??0,hRank??0)||null;
  if(worst==null) return null;
  if(worst<=5) return "Top 5";
  if(worst<=10) return "Top 10";
  if(worst<=15) return "Top 15";
  if(worst<=25) return "Top 25";
  return null;
}

/* ========= Results ========= */
/* Week 0–5 lists unchanged from prior page (trimmed here for brevity) */
const WEEK0=[ // (UvU & UvCPU important games)
  {away:"BYU",a:21,home:"Clemson",h:17},
  {away:"Florida",a:27,home:"Washington",h:42},
  {away:"USC",a:7,home:"Texas",h:40},
  {away:"Miami",a:63,home:"Central Michigan",h:3},
  {away:"Alabama",a:42,home:"Iowa",h:7},
  {away:"LSU",a:26,home:"Indiana",h:24},
  {away:"Penn State",a:57,home:"Temple",h:20},
  {away:"Utah",a:56,home:"Utah State",h:31},
  {away:"UCLA",a:10,home:"California",h:14},
  {away:"Michigan",a:20,home:"Houston",h:0},
  {away:"Baylor",a:37,home:"SMU",h:14}
];
const WEEK1=[
  {away:"Clemson",a:14,home:"LSU",h:31},
  {away:"Georgia",a:26,home:"Miami",h:38},
  {away:"Alabama",a:21,home:"Ohio State",h:14},
  {away:"Arizona State",a:7,home:"South Carolina",h:20},
  {away:"Texas",a:48,home:"Texas State",h:3},
  {away:"Tennessee",a:47,home:"California",h:44},
  {away:"Texas A&M",a:38,home:"Missouri State",h:3},
  {away:"Penn State",a:70,home:"Marshall",h:3},
  {away:"Michigan",a:35,home:"NC State",h:20},
  {away:"Florida State",a:38,home:"Ole Miss",h:24}
];
const WEEK2=[
  {away:"USC",a:13,home:"LSU",h:42},
  {away:"Florida State",a:24,home:"Texas",h:21},
  {away:"Michigan",a:24,home:"Oklahoma",h:10},
  {away:"Arizona State",a:31,home:"Texas A&M",h:13},
  {away:"BYU",a:66,home:"Utah State",h:3},
  {away:"Auburn",a:17,home:"Army",h:7},
  {away:"UCLA",a:31,home:"Kennesaw State",h:7}
];
const WEEK3=[
  {away:"Alabama",a:21,home:"Utah",h:31},
  {away:"LSU",a:28,home:"BYU",h:21},
  {away:"Baylor",a:35,home:"Ohio State",h:41},
  {away:"Washington",a:56,home:"Washington State",h:20},
  {away:"Georgia State",a:21,home:"Georgia",h:56},
  {away:"South Carolina",a:41,home:"Missouri",h:10},
  {away:"Buffalo",a:7,home:"Penn State",h:63},
  {away:"New Mexico",a:21,home:"Oklahoma",h:28},
  {away:"Miami",a:63,home:"Syracuse",h:17},
  {away:"Boston College",a:13,home:"Clemson",h:24},
  {away:"Hawai'i",a:14,home:"Arizona State",h:35},
  {away:"Delaware",a:13,home:"Georgia Tech",h:10}
];
const WEEK4=[
  {away:"Illinois",a:0,home:"North Carolina",h:38},
  {away:"Texas A&M",a:0,home:"Tennessee",h:49},
  {away:"Alabama",a:28,home:"LSU",h:24},
  {away:"Sam Houston",a:6,home:"Texas Tech",h:77},
  {away:"Vanderbilt",a:26,home:"Texas",h:24},
  {away:"Rice",a:14,home:"South Carolina",h:73},
  {away:"Oklahoma",a:0,home:"Ole Miss",h:24},
  {away:"Michigan",a:42,home:"Oregon",h:24},
  {away:"Florida State",a:24,home:"Pittsburgh",h:14},
  {away:"Houston",a:13,home:"Arizona State",h:21}
];
const WEEK5=[
  {away:"North Carolina",a:45,home:"Notre Dame",h:20},
  {away:"Purdue",a:0,home:"Washington",h:49},
  {away:"Oklahoma State",a:24,home:"Texas Tech",h:38},
  {away:"SMU",a:41,home:"Louisville",h:10},
  {away:"Georgia Tech",a:22,home:"Miami",h:48},
  {away:"Tennessee",a:14,home:"Syracuse",h:21},
  {away:"Kansas State",a:7,home:"BYU",h:63}
];
/* Week 6 — BONUS Week: results from your screenshot */
const WEEK6=[
  {away:"Washington",a:49,home:"Indiana",h:7},
  {away:"Virginia",a:24,home:"North Carolina",h:42},
  {away:"Tennessee",a:23,home:"Kentucky",h:33},
  {away:"Texas Tech",a:35,home:"UCF",h:24},
  {away:"Minnesota",a:11,home:"Michigan",h:17},
  {away:"Notre Dame",a:21,home:"Miami",h:42},
  {away:"LSU",a:40,home:"Vanderbilt",h:15},
  {away:"Georgia Tech",a:34,home:"Duke",h:3},
  {away:"Louisville",a:3,home:"Florida State",h:31},
  {away:"California",a:20,home:"Clemson",h:25},
  {away:"Utah",a:2,home:"BYU",h:65},
  {away:"Auburn",a:35,home:"Arkansas",h:38}
  // Some lines on the board had no final yet (e.g., Air Force @ Utah State) – omitted.
];

const WEEKS=[
  {wk:"Week 0",poll:"pre",games:WEEK0},
  {wk:"Week 1",poll:"pre",games:WEEK1},
  {wk:"Week 2",poll:"now",games:WEEK2},
  {wk:"Week 3",poll:"now",games:WEEK3},
  {wk:"Week 4",poll:"now",games:WEEK4},
  {wk:"Week 5",poll:"now",games:WEEK5},
  {wk:"Week 6",poll:"now",games:WEEK6} // BONUS week
];

/* ========= Build completed tables + ticker ========= */
const uvuBody=document.getElementById('uvuBody');
const uvcpuBody=document.getElementById('uvcpuBody');
const tickerRow=document.getElementById('tickerRow');
const tickerItems=[];
const playedByTeam=new Map(ALL_USERS.map(t=>[t,new Set()]));

WEEKS.forEach(({wk,poll,games})=>{
  const wNum=weekNum(wk);
  games.forEach(g=>{
    const {away:A,home:H,a,h}=g;
    const Auser=activeAtWeek(A,wNum), Huser=activeAtWeek(H,wNum);
    if(!(Auser||Huser)) return; // ignore CPU vs CPU

    const ar=rankAt(A,poll), br=rankAt(H,poll);
    const bracket=bracketFrom(ar,br);

    const rowHtml=`
      <tr>
        <td><span class="teamTag" style="${teamStyle(A)}">${ar?`#${ar} `:''}${A}</span></td>
        <td class="${a>h?'cell-win':'cell-loss'}">${a}</td>
        <td><span class="teamTag" style="${teamStyle(H)}">${br?`#${br} `:''}${H}</span></td>
        <td class="${h>a?'cell-win':'cell-loss'}">${h}</td>
        <td>${wk}</td>
        <td>${bracket||'—'}</td>
      </tr>`;

    if(Auser && Huser){ uvuBody.insertAdjacentHTML('beforeend',rowHtml); }
    else { uvcpuBody.insertAdjacentHTML('beforeend',rowHtml); }

    if(Auser) playedByTeam.get(A)?.add(wNum);
    if(Huser) playedByTeam.get(H)?.add(wNum);

    if(ar && br){
      const winner = a>h ? `${A} ${a}–${h}` : `${H} ${h}–${a}`;
      tickerItems.push(`<span>${wk}: #${ar} ${A} @ #${br} ${H} — ${winner}</span>`);
    }
  });
});
tickerRow.innerHTML = tickerItems.join('') || '<span>No ranked user finals yet…</span>';

/* ========= Completion Grid with Week 6 BONUS & former-user handling ========= */
const compHead=document.getElementById('compHead');
const compBody=document.getElementById('compBody');
const weekLabels = ["W0","W1","W2","W3","W4","W5","W6 (Bonus)"];
compHead.innerHTML = `
  <tr>
    <th class="sticky" data-sort="str">Team</th>
    ${weekLabels.map(w=>`<th data-sort="${w.startsWith('W')?'num':'num'}">${w}</th>`).join("")}
    <th data-sort="num">Total</th>
    <th data-sort="str">Joined</th>
  </tr>`;

// Build per-team rows
[...new Set(ALL_USERS)].sort().forEach(team=>{
  const style = teamStyle(team);
  const played = playedByTeam.get(team) || new Set();

  // cells for W0..W5
  const wCells = [];
  for(let n=0;n<=5;n++){
    if(n < joinedWeek(team)) { wCells.push("○"); }       // not in league yet
    else if(n >= leftWeek(team)) { wCells.push("–"); }   // former user
    else { wCells.push( played.has(n) ? "1" : "0" ); }   // completed or missed
  }

  // Week 6 BONUS:
  let w6Cell, w6Credit=0;
  if(6 < joinedWeek(team)) { w6Cell = "○"; w6Credit=0; }
  else if(6 >= leftWeek(team)) { w6Cell = "–"; w6Credit=0; }
  else {
    const playedW6 = played.has(6);
    w6Credit = playedW6 ? 2 : 1;
    w6Cell = String(w6Credit);
  }

  const baseSum = wCells.reduce((s,c)=> s + (c==="1"?1:0), 0);
  const total = baseSum + w6Credit;
  const joinedLabel = (team in LATE_JOINERS) ? `Late (W${LATE_JOINERS[team]})` : "On Time";

  compBody.insertAdjacentHTML('beforeend', `
    <tr class="teamRow" style="${style}">
      <td class="sticky"><span class="teamTag" style="${style}">${team}</span></td>
      ${wCells.map(v=>`<td>${v}</td>`).join("")}
      <td>${w6Cell}</td>
      <td><strong>${total}</strong></td>
      <td>${joinedLabel}</td>
    </tr>
  `);
});

/* ========= Simple table sorting (both tables + grid) ========= */
function makeSortable(table){
  const thead=table.querySelector('thead');
  if(!thead) return;
  thead.addEventListener('click',e=>{
    const th=e.target.closest('th'); if(!th) return;
    [...thead.querySelectorAll('th')].forEach(x=>x.classList.remove('thActive'));
    th.classList.add('thActive');
    const idx=[...th.parentNode.children].indexOf(th);
    const mode=th.dataset.sort||'str';
    const tbody=table.querySelector('tbody');
    const rows=[...tbody.querySelectorAll('tr')];
    const dir=th.dataset.dir==='asc'?'desc':'asc';
    th.dataset.dir=dir;

    rows.sort((r1,r2)=>{
      const a=r1.children[idx].innerText.trim();
      const b=r2.children[idx].innerText.trim();
      const toNum=v=>{
        if(v==="○"||v==="–"||v==="—") return -1;
        const n=parseFloat(v.replace(/[^0-9.-]/g,'')); return isNaN(n)?0:n;
      };
      let cmp=0;
      if(mode==='num'||mode==='wk'){ cmp = toNum(a)-toNum(b); }
      else { cmp = a.localeCompare(b); }
      return dir==='asc'?cmp:-cmp;
    });
    rows.forEach(r=>tbody.appendChild(r));
  });
}
makeSortable(document.getElementById('uvuTable'));
makeSortable(document.getElementById('uvcpuTable'));
makeSortable(document.getElementById('compTable'));
</script>
</body>
</html>
